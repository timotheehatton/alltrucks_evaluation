{% extends "layout.html" %}
{% load static %}

{% block stylesheets %}
<link rel="stylesheet" type="text/css" href="{% static 'css/templates/account/style.css' %}">
{% endblock %}

{% block body %}
<div class="account">
    <h1 class="page-title"><i class="material-icons page-title-icon">manage_accounts</i> Account</h1>

    <div class="row">
        <div class="col s7">
            <div class="card">
                <div class="account-info-title"><i class="material-icons left">person</i>Contact Information</div>
                <div class="account-info-item">
                    <span class="account-info-item-label">Name</span>
                    <p class="account-info-item-content">{{ request.user.first_name }} {{ request.user.last_name }}</p>
                </div>
                <div class="account-info-item">
                    <span class="account-info-item-label">Email Address</span>
                    <p class="account-info-item-content">{{ request.user.email }}</p>
                </div>
                <div class="account-info-item">
                    <span class="account-info-item-label">CT Number</span>
                    <p class="account-info-item-content">{{ request.user.ct_number }}</p>
                </div>
                <div class="separator"></div>
                <div class="account-info-title"><i class="material-icons left">business</i>Workshop Information</div>
                <div class="account-info-item">
                    <span class="account-info-item-label">Company Name</span>
                    <p class="account-info-item-content">{{ request.user.company.name }}</p>
                </div>
                <div class="account-info-item">
                    <span class="account-info-item-label">City</span>
                    <p class="account-info-item-content">{{ request.user.company.city }}</p>
                </div>
                <div class="account-info-item">
                    <span class="account-info-item-label">Country</span>
                    <p class="account-info-item-content">{{ request.user.company.country }}</p>
                </div>
                <div class="account-info-item">
                    <span class="account-info-item-label">CU Number</span>
                    <p class="account-info-item-content">{{ request.user.company.cu_number }}</p>
                </div>

                {% if request.user.user_type == 'technician' %}
                <div class="separator"></div>
                <div class="account-info-title"><i class="material-icons left">person</i>Workshop manager</div>
                <div class="account-info-item">
                    <span class="account-info-item-label">Name</span>
                    <p class="account-info-item-content">{{ request.user.first_name }} {{ request.user.last_name }}</p>
                </div>
                <div class="account-info-item">
                    <span class="account-info-item-label">Email Address</span>
                    <p class="account-info-item-content">{{ request.user.email }}</p>
                </div>
                {% endif %}
            </div>
        </div>
        <div class="col s5">
            <div class="card">
                <div class="account-info-title"><i class="material-icons left">lock</i>Change Password</div>
                <form method="post" action="{% url 'common:change-password' %}">
                    {% csrf_token %}
                    {% for field in password_form %}
                        <div class="input-field">
                            {{ field.label_tag }}
                            {{ field }}
                            {{ field.errors }}
                        </div>
                    {% endfor %}
                    <button type="submit" class="btn blue">Change Password</button>
                </form>
                <ul>
                    {% for message in messages %}
                        {% if "password" in message.message %}
                            <li class="{% if message.tags %} {{ message.tags }} {% endif %}">
                                {% if "success" in message.tags %}
                                    <div class="green lighten-4 green-text">{{ message }}</div>
                                {% elif "error" in message.tags %}
                                    <div class="red lighten-4 red-text">{{ message }}</div>
                                {% else %}
                                    <div class="grey lighten-4 grey-text">{{ message }}</div>
                                {% endif %}
                            </li>
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>
            <div class="separator"></div>
            <div class="card">
                <div class="account-info-title"><i class="material-icons left">settings</i>Settings</div>
                <form method="post" action="{% url 'common:change-language' %}">
                    {% csrf_token %}
                    {% for field in language_form %}
                        <div class="input-field">
                            <label for="{{ field.id_for_label }}" class="active">{{ field.label }}</label>
                            {{ field }}
                            {% if field.errors %}
                                <span class="helper-text" data-error="wrong" data-success="right">{{ field.errors }}</span>
                            {% endif %}
                        </div>
                    {% endfor %}
                    <button type="submit" class="btn blue">Update Language</button>
                </form>
                {% if messages %}
                <ul>
                    {% for message in messages %}
                        {% if "language" in message.message %}
                            <li class="{% if message.tags %} {{ message.tags }} {% endif %}">
                                {% if "success" in message.tags %}
                                    <div class="green lighten-4 green-text">{{ message }}</div>
                                {% elif "error" in message.tags %}
                                    <div class="red lighten-4 red-text">{{ message }}</div>
                                {% else %}
                                    <div class="grey lighten-4 grey-text">{{ message }}</div>
                                {% endif %}
                            </li>
                        {% endif %}
                    {% endfor %}
                </ul>
                {% endif %}
            </div>
            {% if request.user.is_authenticated %}
            <div class="separator"></div>
            <div class="card">
                <div class="account-info-title"><i class="material-icons left">power_settings_new</i>Logout from your account</div>
                <form action="{% url 'logout' %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn red">Logout</button>
                </form>
            </div>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}